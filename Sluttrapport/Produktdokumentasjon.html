<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="UTF-8">
		<title> Produktdokumentasjon</title>
		<link rel="stylesheet" type="text/css" href="style.css">
	</head>
<body>
	
	<header>
		<h2>Boligformidling</h2>
		<p>Eivind Schulstad - s198752 - Dataingeniør</p>
		<p>Gretar Ævarsson - s198586 - Informasjonsteknologi</p>
		<p>Sigurd Hølleland - s198597 - Informasjonsteknologi</p>
	</header>
		 <section id="content">
<h1>Produktdokumentasjon</h1>

<h2>Oppbygning av programmet</h2>
	<h3>Klassehierarki</h3>
	<p>Vi har tre klasser som utgjør objektene som brukes i programmet, dvs. person, bolig og kontrakt.
	Person-klassen har to subklasser, utleiere og boligsøkere. Bolig-klassen har også to subklasser, 
	enebolig/rekkehus og leilighet.</p>
	<img src="klassehierarki.png" alt="Klassehierarki">
	
	<h3>Datastruktur</h3>
	<p>Objektene lagres i en datastruktur, dvs. Person-objektene lagres i en TreeSet-mengde og hvert Utleier-objekt innholder 
	en LinkedList-liste over alle boliger vedkommende er knyttet til. Vi valgte TreeSet datastrukturen for Personer fordi det hindrer dobbeltlagring 
	og er sortert (f.eks. mht. personens navn). Vi valgte LinkedList datastrukturen for Boligene fordi den er effektiv når man skal 
	sette inn og fjerne objekter, som er en stor del av vår program.</p>
	<p>Kontrakt klassen inneholder to ArrayList-lister, en for gjeldende kontrakter og en for arkviverte kontrakter.
	Vi valgte ArrayList-liste fordi der er effektivt å søke gjennom og hente ut data (bruke indekser). 
	Samtidig skal vi heller ikke fjerne noe fra listen.</p>
	<img src="datastruktur.png" alt="Datastruktur">	
		
	<h3>Programstruktur</h3>
	<p>Programmet har en træstruktur, dvs. alle klassene tilhører en øvrige klasse, utenfør klassen som inneholder
	main metoden (se diagram her under). Hver klasse er beskrevet nedenfor.</p>
	<img src="programstruktur.png" alt="Programstruktur">	
		
		<h4>Boligformidleren.java</h4>
		Denne klassen inneholder main-metoden og den oppretter et StartVindu-objekt, som åpnes når programmet er kjørt.
		Lukkeknappen på StartVinduet er programmert slik at den skriver alle mengder og lister til fil før programmet avsluttes. 
		
		<h4>StartVindu.java</h4>
		Denne klassen inneholder alle andre vindu-klassene (utleiervindu, boligsøkervindu, boligvindu, kontraktvindu, informasjonvindu)
		og kobler dem sammen med get-metoder (static). Dette betyr at alle klassene har tilgang til hver annen i gjennom denne klassen.
		StartVindu-klassen inneholder i tillegg alle konstanter (static) som brukes av mer enn en klasse, f.eks. regulære uttrykk (regex) mønstre.
		Til slutt inneholder denne klassen generelle metoder som bruker i andre klasser, f.eks. for regex, skrive data til fil o.fl.
		
		StartVindu.java inneholder følgende metoter
		<code><ul>
			<li>public StartVindu() - konstruktør</li>
			<li>public static UtleierVindu getUtleierVindu()</li>
			<li>public static BoligsoekerVindu getBoligsoekerVindu()</li>
			<li>public static BoligVindu getBoligVindu()</li>
			<li>public static KontraktVindu getKontraktVindu()</li>
			<li>public static InformasjonVindu getInformasjonVindu()</li>
			<li>public static boolean kontrollerRegEx(String pattern, JTextField[] input)</li>
			<li>public static String kontrollerRegExTomFeltOK(String pattern, JTextField[] input)</li>
			<li>public static boolean kontrollerRegEx(String pattern, String input)</li>
			<li>public static int konverterBlanktFeltTilHeltall(JTextField jtf)</li>
			<li>public static boolean tekstFeltErTomt(JTextField[] jtf)</li>
			<li>public static Date konverterDato(String datostreng)</li>
			<li>public void generateData() - ikke i bruk (brukt ved utvikling av programmet)</li>
			<li>public void skrivTilFil()</li>
			<li>public static void visFeilmelding(StackTraceElement[] ste)</li>
			<li>public static void visFeilmelding(Object o)</li>
			<li>public static String visJaNeiMelding(String melding, String vindutekst)</li>
			<li>public void actionPerformed(ActionEvent e)</li>
		</ul></code>
		
		<h4>UtleierVindu.java</h4>
		Denne klassen brukes når man skal registrere, slette eller endre en utleier, dvs. den inneholder alle nødvendige felter og knapper
		og alle metodene som kalles når brukeren trykker på knappene.
		I tilleg inneholder den UtleierMengde-klassen (hvor alle utleier-objektene ligger).
		
		UtleierVindu.java inneholder følgende metoter
		<code><ul>
			<li>public UtleierVindu() - konstruktør</li>
			<li>public UtleierMengde getUtleierMengde()</li>
			<li>public void regUtleier()</li>
			<li>public void slettUtleier()</li>
			<li>public void blankFelter()</li>
			<li>public boolean regexOK()</li>
			<li>public void endreFelt(String felt, String ny)</li>
			<li>public void skrivUtleierTilFil()</li>
			<li>public void lesUtleierFraFil()</li>
			<li>public void actionPerformed(ActionEvent e)</li>
			<li>public void focusGained(FocusEvent fe)</li>
			<li>public void focusLost(FocusEvent fe) - brukt for auto-fill</li>
		</ul></code>
		
		<h4>UtleierMengde.java</h4>
		Denne klassen inneholder mengden selv (TreeSet) og alle metodene som brukes når man vil sette inn et nytt utleier-objekt,
		fjerne eller finner en utleier.
		I tillegg inneholder den metoder for at registrere bolig-objekter til en utleier, fordi man må først søke gjennom alle
		utleierene om den boligen eksisterer fra før.
		
		UtleierMengde.java inneholder følgende metoter
		<code><ul>
			<li>public void focusLost(FocusEvent fe) - brukt for auto-fill</li>
			<li>public boolean fjern(Utleier ul)</li>
			<li>public Utleier finnUtleier(String fornavn, String etternavn)</li>
			<li>public Bolig finnBolig(String gateadresse, int postnr, String poststed)</li>
			<li>public boolean regBolig(Utleier u, Bolig b)</li>
			<li>public Set<Utleier> kopierMengdeUsortert()</li>
			<li>public int antallBoliger()</li>
			<li>public Set<Utleier> getSortertMengde()</li>
			<li>public String toString()</li>
		</ul></code>
		

<h3>Filbehandlingen</h3>

<p>Programmet lagrer data på 3 forskjellige filer, hhv. boligsoekermengde.data,
kontraktliste.data og utleiermengde.data. Når for eksempel boligsøkere registreres
legges objektene inn i en TreeSet, og det er denne som i sin tur skrives til fila 
boligsoekermengde.data. Omtrent tilsvarende skjer for utleiere og kontrakter. </p>

<p>Hver av disse datastrukturene har altså sine egne skrivTilFil og lesFraFil-metoder, 
som ligger i deres tilsvarende -Vindu klasser. Disse kalles opp hver gang programmet 
avsluttes og startes opp.</p>

<p>Vi valgte å definere en egen norsk tilpasset sorteringsrekkefølge for utleiere og 
boligsøkere. Dette ble gjort ved at TreeSet'en de to datatypene ligger lagret i er
opprettet sammen med en Comparator som definerer sorteringen gjennom en
RuleBasedCollator. Denne RuleBasedCollator er ikke serialiserbar noe som kompliserer 
filbehandlingen av utleiere og boligsøkere noe. Måten det er løst på i programmet er 
at de sorterte mengdene av utleiere og boligsøkere kopieres over i en usortert mengde 
når skrivTilFil-operasjonen gjennomføres. Dette gjennom metodene kopierMengdeUsortert 
i UtleierMengde og BoligsoekerMengde. Objektene skrives altså usortert over til fil. 
Objektene leses deretter inn en for en og legges inn i TreeSet'en hvor de sorteres.</p>

<p>For kontrakter er det hele mye enklere. Programmet oppretter et KontraktListe-objekt
der listen over gjeldende og utløpte kontrakter ligger. Hele dette objektet skrives
til og leses fra fil ved hver oppstart/avslutning.</p>

<h3>Om kontrakters utløpstid</h3>

<p>Lagringen og behandlingen av oppretede kontrakter foregår i klassen KontraktListe.
Her ligger det to lister av typen ArrayList, den ene for kontrakter som fortsatt er
gjeldende, den andre for kontrakter som er utløpt. Ideen/hensikten er at alle nylige
opprettede kontrakter legges i en separat liste, når utløpsdatoen for kontraktene er
passert flyttes disse automatisk over i en annen liste. Dette skiller gjeldende og
kontrakter fra kontrakter som kun er av historisk betydning på en enkel og
oversiktlig måte, forutsetningen er selvsagt at datokontrollen er god nok. En mulig
svakhet ved datokontrollen i dette programmet er at den kun gjennomføres for hver 
oppstart, dvs. programmet sjekker utløpsdatoen i kontrakten opp mot dagens dato,
er utløpsdatoen passert legges kontrakten(e) over i arkivet. Brukeren av programmet
er derfor avhengig av å avslutte og starte opp igjen programmet minst en gang daglig.</p>

<p>
Dette får en muligens subtil betydning ved registrering av kontrakter, nemlig at alle
nyregistrerte kontrakter behandles som "gjeldende" uavhengig av om den satte sluttdatoen 
er før dagens dato. Det er altså først etter en restart av programmet at kontrakten 
vil bli sjekket og lagt i arkivet.</p>

<h3>Mer om kontrakter</h3>

<p>
Kontraktregistreringen fungerer slik at en boligsøker kun kan ha en gjeldende
kontrakt registrert på seg til enhver tid. Det er altså ikke mulig å leie flere
enn en bolig av gangen. Det er valgt slik for å gjøre programmet og håndteringen av
kontrakter enklere. Dette betyr at så lenge en boligsøker er registrert med en
gjeldende kontrakt, er det ikke mulig å registrere en ny kontrakt på samme boligsøker.
Det samme gjelder for boligen. Den har et statusfelt "ledig"(true). Når en bolig knyttes
til en kontrakt blir statusfeltet satt til "ikke ledig"(false), og det er ikke mulig
å registrere en ny kontrakt på denne boligen. Når en kontrakt går ut forandres statusen
samtidig til "ledig" igjen.</p>

<h3>Om tabeller</h3>

<p>
Alle tabeller i programmet er av typen JTable, og har en egen definert tabellmodell
som bestemmer innhold og utseende til tabellen. Dette ligger i klassene
BoligTabellmodell, BoligsoekerTabellmodell og UtleierTabellmodell. En viktig funksjon
ved tabellene er at brukeren skal kunne velge en rad, trykke på "Gå til ..." knappen
for å få opp detaljert informasjon om personen/boligen i raden. For å få til dette
ligger det to kolonner i hhv. utleier og boligsøkertabellen som inneholder fornavn og 
etternavn som er skjulte for brukeren, og som kun brukes av metodene hentXxxFraTabell 
i InformasjonVindu.</p>


		 </section>
		<footer>
			<p> <em> <u> Eivind (DataIng - s198752), Gretar (IT - s198586), Sigurd (IT - s198597)</u> </em> </P>
		</footer>			
		
</body>
</html>